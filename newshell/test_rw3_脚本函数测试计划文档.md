# 脚本函数测试计划文档

## 1. 测试概述

本测试脚本用于验证 `file_rw3.sh` 中各个函数的功能正确性，重点测试以下方面：
- 中文字符和特殊字符处理
- 包含空格的路径处理
- 标志位读写正确性
- 边界条件处理
- 错误处理机制

## 2. 各函数测试计划

### 2.1 get_byte_length() 函数测试
**功能**: 获取字符串的字节长度（支持中文和特殊字符）

**测试用例**:
- TC01: 纯英文字符串
- TC02: 纯中文字符串
- TC03: 中英文混合字符串
- TC04: 包含特殊字符和emoji的字符串
- TC05: 空字符串
- TC06: 超长字符串

### 2.2 parse_path_list() 函数测试
**功能**: 解析路径列表，支持大括号扩展和引号处理

**测试用例**:
- TC01: 单个简单路径
- TC02: 多个路径用空格分隔
- TC03: 包含空格的路径（用引号包围）
- TC04: 包含中文的路径
- TC05: 大括号扩展语法 `/path/v{1..5}`
- TC06: 换行分隔的路径列表
- TC07: 混合引号和非引号路径
- TC08: 包含特殊字符的路径

### 2.3 write_fixed_bytes() 函数测试
**功能**: 向文件末尾追加1100字节数据（100字节标志位 + 1000字节内容）

**测试用例**:
- TC01: 写入纯英文文件名
- TC02: 写入纯中文文件名
- TC03: 写入中英文混合文件名
- TC04: 写入包含特殊字符的文件名
- TC05: 写入超长文件名（>1000字节）
- TC06: 写入空字符串
- TC07: 向不存在的文件写入
- TC08: 向包含空格和中文的路径写入

### 2.4 read_and_remove_fixed_bytes() 函数测试
**功能**: 读取文件末尾1100字节并还原字符串，然后删除这1100字节

**测试用例**:
- TC01: 读取正确格式的文件
- TC02: 读取包含中文内容的文件
- TC03: 读取文件大小不足1100字节的文件
- TC04: 读取标志位不匹配的文件
- TC05: 读取不存在的文件
- TC06: 读取只读权限的文件

### 2.5 process_folders() 函数测试
**功能**: 批量处理文件夹中的文件（追加文件名到末尾）

**测试用例**:
- TC01: 处理包含普通文件的文件夹
- TC02: 处理包含中文文件名的文件夹
- TC03: 处理包含空格和特殊字符的文件夹路径
- TC04: 处理包含tmpfile后缀文件的文件夹（应跳过）
- TC05: 处理空文件夹
- TC06: 处理不存在的文件夹
- TC07: 处理包含url文件的文件夹（应删除）
- TC08: 使用大括号扩展处理多个文件夹

### 2.6 restore_file_names() 函数测试
**功能**: 批量还原文件名（从文件末尾读取并重命名）

**测试用例**:
- TC01: 还原普通文件名
- TC02: 还原中文文件名
- TC03: 还原到已存在的文件名（应添加时间戳）
- TC04: 还原标志位不匹配的文件
- TC05: 处理不存在的文件夹
- TC06: 处理空文件夹

### 2.7 getFileName() 函数测试
**功能**: 获取带序号的文件名

**测试用例**:
- TC01: 首次调用（创建索引文件）
- TC02: 多次连续调用（验证递增）
- TC03: 索引文件不存在的情况
- TC04: 索引文件内容损坏的情况
- TC05: 索引文件权限问题

### 2.8 isVideoFileFunction() 函数测试
**功能**: 判断文件是否为视频文件

**测试用例**:
- TC01: 常见视频格式文件(.mp4, .avi, .mkv等)
- TC02: 非视频文件(.txt, .jpg, .doc等)
- TC03: 无扩展名文件
- TC04: 大写扩展名文件
- TC05: 不存在的文件
- TC06: 包含中文和空格的文件路径

### 2.9 processVideoFiles() 函数测试
**功能**: 递归处理视频文件（>100MB）

**测试用例**:
- TC01: 处理包含大视频文件的文件夹
- TC02: 处理包含小视频文件的文件夹（<100MB，应跳过）
- TC03: 处理包含aria2后缀文件的文件夹（应跳过）
- TC04: 处理包含非视频文件的文件夹
- TC05: 递归处理嵌套文件夹

### 2.10 moveProcessedFiles() 函数测试
**功能**: 识别并移动带标志位的文件

**测试用例**:
- TC01: 移动带标志位的普通文件
- TC02: 移动带标志位的中文文件名文件
- TC03: 移动到已存在同名文件的情况
- TC04: 处理无标志位的文件（应跳过）
- TC05: 目标文件夹不存在的情况
- TC06: 权限不足的情况

### 2.11 view_original_names() 函数测试
**功能**: 查看文件原始文件名（不删除数据）

**测试用例**:
- TC01: 查看带标志位的文件
- TC02: 查看无标志位的文件
- TC03: 查看文件大小不足的文件
- TC04: 查看包含中文内容的文件

### 2.12 batch_view_original_names() 函数测试
**功能**: 批量查看文件夹中文件的原始文件名

**测试用例**:
- TC01: 批量查看带标志位的文件
- TC02: 批量查看混合文件（有标志位和无标志位）
- TC03: 处理空文件夹
- TC04: 处理不存在的文件夹

## 3. 测试环境准备

### 3.1 测试文件夹结构
```
test_workspace/
├── 普通文件夹/
├── 中文 空格 文件夹/
├── special@#$folder/
├── 测试视频文件夹/
├── 临时测试文件夹/
└── 移动目标文件夹/
```

### 3.2 测试文件类型
- 小文本文件（<1100字节）
- 大文本文件（>1100字节）
- 视频文件（大于和小于100MB）
- 带标志位的文件
- 各种编码的文件（UTF-8, GBK等）

## 4. 测试数据
- 英文文件名: `test.txt`, `video.mp4`
- 中文文件名: `测试文件.txt`, `视频文件.mp4`
- 混合文件名: `test 测试 file.txt`
- 特殊字符文件名: `test@#$%.txt`
- 长文件名: `这是一个非常长的文件名...`（>100字符）

## 5. 预期结果验证
每个测试用例都会验证：
- 返回码是否正确
- 输出内容是否符合预期
- 文件操作是否正确执行
- 错误处理是否恰当
- 中文和特殊字符是否正确处理

## 6. 测试报告
测试完成后生成详细报告，包括：
- 每个函数的测试通过率
- 失败用例的详细信息
- 性能指标（如适用）
- 建议和改进意见